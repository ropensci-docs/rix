<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>d1 - Installing R packages in a Nix environment • rix</title>
<!-- rOpenSci favicons --><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="/apple-touch-icon.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="d1 - Installing R packages in a Nix environment">
<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/orestbida/cookieconsent@v3.0.0/dist/cookieconsent.css">
<script src="https://cdn.jsdelivr.net/gh/orestbida/cookieconsent@v3.0.0/dist/cookieconsent.umd.js" data-cfasync="false"></script><script src="https://ropensci.org/scripts/matomo.js"></script><noscript><p><img src="https://ropensci.matomo.cloud/matomo.php?idsite=1&amp;rec=1" style="border:0;" alt=""></p></noscript>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">
    <a href="https://ropensci.org" class="external-link"><img src="https://ropensci.org/img/icon_short_white.svg" id="hexlogo" alt="rOpenSci"></a>
    <a class="navbar-brand me-2" href="../index.html">rix</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.15.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"></ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/a-getting-started.html">a - Getting started</a></li>
    <li><a class="dropdown-item" href="../articles/b1-setting-up-and-using-rix-on-linux-and-windows.html">b1 - Setting up and using Nix and rix on Linux and Windows</a></li>
    <li><a class="dropdown-item" href="../articles/b2-setting-up-and-using-rix-on-macos.html">b2 - Setting up and using Nix and rix on macOS</a></li>
    <li><a class="dropdown-item" href="../articles/c-using-rix-to-build-project-specific-environments.html">c - Using rix to build project specific environments</a></li>
    <li><a class="dropdown-item" href="../articles/d1-installing-r-packages-in-a-nix-environment.html">d1 - Installing R packages in a Nix environment</a></li>
    <li><a class="dropdown-item" href="../articles/d2-installing-system-tools-and-texlive-packages-in-a-nix-environment.html">d2 - Installing system tools and TexLive packages in a Nix environment</a></li>
    <li><a class="dropdown-item" href="../articles/e-configuring-ide.html">e - Using an IDE with Nix shells</a></li>
    <li><a class="dropdown-item" href="../articles/f-renv2nix.html">f - Converting renv projects to Nix projects</a></li>
    <li><a class="dropdown-item" href="../articles/z-advanced-topic-building-an-environment-for-literate-programming.html">z - Advanced topic: Building an environment for literate programming</a></li>
    <li><a class="dropdown-item" href="../articles/z-advanced-topic-handling-packages-with-remote-dependencies.html">z - Advanced topic: Handling packages with remote dependencies</a></li>
    <li><a class="dropdown-item" href="../articles/z-advanced-topic-reproducible-analytical-pipelines-with-nix.html">z - Advanced topic: Reproducible Analytical Pipelines with Nix</a></li>
    <li><a class="dropdown-item" href="../articles/z-advanced-topic-running-r-or-shell-code-in-nix-from-r.html">z - Advanced topic: Running R or Shell Code in Nix from R</a></li>
    <li><a class="dropdown-item" href="../articles/z-advanced-topic-using-nix-inside-docker.html">z - Advanced topic: Using Nix inside Docker</a></li>
    <li><a class="dropdown-item" href="../articles/z-binary_cache.html">z - Advanced topic: Rolling out your own binary cache</a></li>
    <li><a class="dropdown-item" href="../articles/z-bleeding_edge.html">z - Advanced topic: Understanding the rPackages set release cycle and using bleeding edge packages</a></li>
    <li><a class="dropdown-item" href="../articles/z-contributing_to_nixpkgs.html">z - Advanced topic: Contributing to nixpkgs</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ropensci/rix/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>d1 - Installing R packages in a Nix environment</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ropensci/rix/blob/master/vignettes/d1-installing-r-packages-in-a-nix-environment.Rmd" class="external-link"><code>vignettes/d1-installing-r-packages-in-a-nix-environment.Rmd</code></a></small>
      <div class="d-none name"><code>d1-installing-r-packages-in-a-nix-environment.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>You now know how to declare and build reproducible development
environments using <a href="https://docs.ropensci.org/rix/">rix</a> and Nix. This vignette will
explain how to install specific versions of CRAN packages and how to
install packages from GitHub.</p>
</div>
<div class="section level2">
<h2 id="a-word-of-caution">A word of caution<a class="anchor" aria-label="anchor" href="#a-word-of-caution"></a>
</h2>
<p>It is important at this stage to understand that you should not call
<code><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages()</a></code> from a running Nix environment. Doing so
will raise an error to avoid issues. If you want to add packages while
analyzing data, you need to add it the <code>default.nix</code>
expression and rebuild the environment. The same goes for installing
packages from GitHub; use the method described in this vignette instead
of using something like <code><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">remotes::install_github()</a></code>.</p>
<p>We recommend you create a script called <code>create_env.R</code> or
similar, and add the call to <code><a href="../reference/rix.html">rix()</a></code> there:</p>
<pre><code><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/rix/">rix</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/rix.html">rix</a></span><span class="op">(</span>r_ver <span class="op">=</span> <span class="st">"4.4.0"</span>,</span>
<span>    r_pkgs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"dplyr"</span>, <span class="st">"ggplot2"</span><span class="op">)</span>,</span>
<span>    system_pkgs <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    git_pkgs <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    ide <span class="op">=</span> <span class="st">"code"</span>,</span>
<span>    project_path <span class="op">=</span> <span class="va">path_default_nix</span>,</span>
<span>    overwrite <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    print <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre>
<p>Then, add the packages you need to <code>r_pkgs</code> and run the
script again. Then, build the environment using <code>nix-build</code>
again, and drop into it using <code>nix-shell</code>. Calling
<code><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages()</a></code> is a bad idea for several reasons:</p>
<ul>
<li>it goes against the idea of defining an environment in a declarative
way. If you were able to add packages using
<code><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages()</a></code>, your environment would end up in a
state where the <code>default.nix</code> definition of the environment
and the actual environment don’t match anymore.</li>
<li>using <code><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages()</a></code> would likely simply not work,
and if it would work, it would cause issues. For example, if you call
<code>install.packages("ggplot2")</code> from one Nix shell, it will not
install <a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a> “inside” the Nix shell, but will install
it on your user’s system library of packages. This is because the Nix
shell cannot be changed at run-time, and so, R will instead install the
packages in the user’s library. This version of <a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a>,
because it is in that system-wide library of packages, will be available
to any other Nix shells. If you call
<code>install.packages("ggplot2")</code> again from another Nix shell,
say 6 months later, this will replace the first version of
<a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a> with the latest version.</li>
</ul>
<p>Ideally, you should only manage R versions and R packages using Nix,
and uninstall any system-managed version of R and R packages. But if you
do wish to keep a system-managed version of R and R packages,
<code><a href="../reference/rix.html">rix::rix()</a></code> also runs <code><a href="../reference/rix_init.html">rix::rix_init()</a></code>
automatically which generates an <code>.Rprofile</code> file that avoids
any clashes between your global user library and Nix-managed libraries
of R packages.</p>
</div>
<div class="section level2">
<h2 id="installing-old-packages-archived-on-cran">Installing old packages archived on CRAN<a class="anchor" aria-label="anchor" href="#installing-old-packages-archived-on-cran"></a>
</h2>
<p>It is possible to install an arbitrary version of a package that has
been archived on CRAN:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">path_default_nix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/rix.html">rix</a></span><span class="op">(</span></span>
<span>  r_ver <span class="op">=</span> <span class="st">"4.2.1"</span>,</span>
<span>  r_pkgs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"dplyr@0.8.0"</span>, <span class="st">"janitor@1.0.0"</span><span class="op">)</span>,</span>
<span>  system_pkgs <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  git_pkgs <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ide <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>  project_path <span class="op">=</span> <span class="va">path_default_nix</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; let</span></span>
<span><span class="co">#&gt;  pkgs = import (fetchTarball "https://github.com/NixOS/nixpkgs/archive/79b3d4bcae8c7007c9fd51c279a8a67acfa73a2a.tar.gz") {};</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt;   git_archive_pkgs = [</span></span>
<span><span class="co">#&gt;     (pkgs.rPackages.buildRPackage {</span></span>
<span><span class="co">#&gt;       name = "dplyr";</span></span>
<span><span class="co">#&gt;       src = pkgs.fetchzip {</span></span>
<span><span class="co">#&gt;        url = "https://cran.r-project.org/src/contrib/Archive/dplyr/dplyr_0.8.0.tar.gz";</span></span>
<span><span class="co">#&gt;        sha256 = "sha256-f30raalLd9KoZKZSxeTN71PG6BczXRIiP6g7EZeH09U=";</span></span>
<span><span class="co">#&gt;       };</span></span>
<span><span class="co">#&gt;       propagatedBuildInputs = builtins.attrValues {</span></span>
<span><span class="co">#&gt;         inherit (pkgs.rPackages)</span></span>
<span><span class="co">#&gt;           assertthat</span></span>
<span><span class="co">#&gt;           glue</span></span>
<span><span class="co">#&gt;           magrittr</span></span>
<span><span class="co">#&gt;           pkgconfig</span></span>
<span><span class="co">#&gt;           R6</span></span>
<span><span class="co">#&gt;           Rcpp</span></span>
<span><span class="co">#&gt;           rlang</span></span>
<span><span class="co">#&gt;           tibble</span></span>
<span><span class="co">#&gt;           tidyselect</span></span>
<span><span class="co">#&gt;           BH</span></span>
<span><span class="co">#&gt;           plogr;</span></span>
<span><span class="co">#&gt;       };</span></span>
<span><span class="co">#&gt;     })</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt;     (pkgs.rPackages.buildRPackage {</span></span>
<span><span class="co">#&gt;       name = "janitor";</span></span>
<span><span class="co">#&gt;       src = pkgs.fetchzip {</span></span>
<span><span class="co">#&gt;        url = "https://cran.r-project.org/src/contrib/Archive/janitor/janitor_1.0.0.tar.gz";</span></span>
<span><span class="co">#&gt;        sha256 = "sha256-3NJomE/CNbOZ+ohuVZJWe2n1RVGUm8x8a0A0qzLmdN4=";</span></span>
<span><span class="co">#&gt;       };</span></span>
<span><span class="co">#&gt;       propagatedBuildInputs = builtins.attrValues {</span></span>
<span><span class="co">#&gt;         inherit (pkgs.rPackages)</span></span>
<span><span class="co">#&gt;           dplyr</span></span>
<span><span class="co">#&gt;           tidyr</span></span>
<span><span class="co">#&gt;           snakecase</span></span>
<span><span class="co">#&gt;           magrittr</span></span>
<span><span class="co">#&gt;           purrr</span></span>
<span><span class="co">#&gt;           rlang;</span></span>
<span><span class="co">#&gt;       };</span></span>
<span><span class="co">#&gt;     })</span></span>
<span><span class="co">#&gt;   ];</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt;   system_packages = builtins.attrValues {</span></span>
<span><span class="co">#&gt;     inherit (pkgs)</span></span>
<span><span class="co">#&gt;       R</span></span>
<span><span class="co">#&gt;       glibcLocales</span></span>
<span><span class="co">#&gt;       nix;</span></span>
<span><span class="co">#&gt;   };</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; in</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; pkgs.mkShell {</span></span>
<span><span class="co">#&gt;   LOCALE_ARCHIVE = if pkgs.system == "x86_64-linux" then  "${pkgs.glibcLocales}/lib/locale/locale-archive" else "";</span></span>
<span><span class="co">#&gt;   LANG = "en_US.UTF-8";</span></span>
<span><span class="co">#&gt;    LC_ALL = "en_US.UTF-8";</span></span>
<span><span class="co">#&gt;    LC_TIME = "en_US.UTF-8";</span></span>
<span><span class="co">#&gt;    LC_MONETARY = "en_US.UTF-8";</span></span>
<span><span class="co">#&gt;    LC_PAPER = "en_US.UTF-8";</span></span>
<span><span class="co">#&gt;    LC_MEASUREMENT = "en_US.UTF-8";</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt;   buildInputs = [ git_archive_pkgs   system_packages   ];</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; }</span></span></code></pre>
<p>The above expression will install R version 4.2.1, and
<a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a> at version 0.8.0 and <a href="https://github.com/sfirke/janitor" class="external-link">janitor</a> at
version 1.0.0. This can be useful, especially for packages that have
been archived, but otherwise, this feature should ideally be used
sparingly, for two reasons. First, if you want to reconstruct an
environment as it was around 2019, use the version of R that was current
at that time using the <code>date</code> argument in <code><a href="../reference/rix.html">rix()</a></code>.
This will ensure that every package that gets installed is at a version
compatible with that version of R, which might not be the case if you
need to install a very old version of one particular package. Second,
doing so will install the package from source. For packages that don’t
require compilation, this should be fine, but packages that require
compilation will likely fail to compile successfully. We are working on
handling this better for future versions of <a href="https://docs.ropensci.org/rix/">rix</a>.</p>
</div>
<div class="section level2">
<h2 id="installing-packages-from-github">Installing packages from GitHub<a class="anchor" aria-label="anchor" href="#installing-packages-from-github"></a>
</h2>
<p>It is also possible to install packages from GitHub:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">path_default_nix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/rix.html">rix</a></span><span class="op">(</span></span>
<span>  r_ver <span class="op">=</span> <span class="st">"4.2.1"</span>,</span>
<span>  r_pkgs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"dplyr"</span>, <span class="st">"janitor"</span><span class="op">)</span>,</span>
<span>  git_pkgs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      package_name <span class="op">=</span> <span class="st">"housing"</span>,</span>
<span>      repo_url <span class="op">=</span> <span class="st">"https://github.com/rap4all/housing/"</span>,</span>
<span>      commit <span class="op">=</span> <span class="st">"1c860959310b80e67c41f7bbdc3e84cef00df18e"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      package_name <span class="op">=</span> <span class="st">"fusen"</span>,</span>
<span>      repo_url <span class="op">=</span> <span class="st">"https://github.com/ThinkR-open/fusen"</span>,</span>
<span>      commit <span class="op">=</span> <span class="st">"d617172447d2947efb20ad6a4463742b8a5d79dc"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  ide <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>  project_path <span class="op">=</span> <span class="va">path_default_nix</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>This will install two packages from GitHub: the
<code>{housing}</code> package and more specifically the code as it is
in the <code>fusen</code> branch; however the branch name is not
required, as the commit is enough to pin the exact version of the code
needed. The <a href="https://thinkr-open.github.io/fusen/" class="external-link">fusen</a> package is also installed, as of commit
<code>d617172447d</code>.</p>
</div>
<div class="section level2">
<h2 id="installing-local-archives">Installing local archives<a class="anchor" aria-label="anchor" href="#installing-local-archives"></a>
</h2>
<p>It is also possible to install packages from a local
<code>tar.gz</code> file. For this, place the package in the same folder
where the <code>default.nix</code> will be generated, and write
something like this:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/rix.html">rix</a></span><span class="op">(</span></span>
<span>  r_ver <span class="op">=</span> <span class="st">"4.3.1"</span>,</span>
<span>  local_r_pkgs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"chronicler_0.2.1.tar.gz"</span>, <span class="st">"knitr_1.43.tar.gz"</span><span class="op">)</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>This assumes that both <code>chronicler_0.2.1.tar.gz</code> and
<code>knitr_1.43.tar.gz</code> have been downloaded beforehand. If you
want to include a local package that you are developing, make sure to
first build it using <code>devtools::build()</code> to build the
<code>.tar.gz</code> archive, but if you can, consider uploading the
source code to your package on GitHub and installing it from GitHub
instead.</p>
</div>
<div class="section level2">
<h2 id="converting-from-an-renv-lock-file">Converting from an renv.lock file<a class="anchor" aria-label="anchor" href="#converting-from-an-renv-lock-file"></a>
</h2>
<p><a href="https://docs.ropensci.org/rix/">rix</a> also includes an <code><a href="../reference/renv2nix.html">renv2nix()</a></code> function
that converts an <code>renv.lock</code> file into a valid Nix
expression. Read the vignette <code><a href="../articles/f-renv2nix.html">vignette("f-renv2nix")</a></code> to
learn more.</p>
</div>
<div class="section level2">
<h2 id="a-complete-example">A complete example<a class="anchor" aria-label="anchor" href="#a-complete-example"></a>
</h2>
<p>This example shows how to install packages from CRAN, from the CRAN
archives and from GitHub:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">path_default_nix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/rix.html">rix</a></span><span class="op">(</span></span>
<span>  r_ver <span class="op">=</span> <span class="st">"4.2.1"</span>,</span>
<span>  r_pkgs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"dplyr"</span>, <span class="st">"janitor"</span>, <span class="st">"AER@1.2-8"</span><span class="op">)</span>,</span>
<span>  git_pkgs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      package_name <span class="op">=</span> <span class="st">"housing"</span>,</span>
<span>      repo_url <span class="op">=</span> <span class="st">"https://github.com/rap4all/housing/"</span>,</span>
<span>      commit <span class="op">=</span> <span class="st">"1c860959310b80e67c41f7bbdc3e84cef00df18e"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      package_name <span class="op">=</span> <span class="st">"fusen"</span>,</span>
<span>      repo_url <span class="op">=</span> <span class="st">"https://github.com/ThinkR-open/fusen"</span>,</span>
<span>      commit <span class="op">=</span> <span class="st">"d617172447d2947efb20ad6a4463742b8a5d79dc"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  ide <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>  project_path <span class="op">=</span> <span class="va">path_default_nix</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; # This file was generated by the {rix} R package v0.7.1 on 2024-07-01</span></span>
<span><span class="co">#&gt; # with following call:</span></span>
<span><span class="co">#&gt; # &gt;rix(r_ver = "79b3d4bcae8c7007c9fd51c279a8a67acfa73a2a",</span></span>
<span><span class="co">#&gt; #  &gt; r_pkgs = c("dplyr",</span></span>
<span><span class="co">#&gt; #  &gt; "janitor",</span></span>
<span><span class="co">#&gt; #  &gt; "AER@1.2-8"),</span></span>
<span><span class="co">#&gt; #  &gt; git_pkgs = list(list(package_name = "housing",</span></span>
<span><span class="co">#&gt; #  &gt; repo_url = "https://github.com/rap4all/housing/",</span></span>
<span><span class="co">#&gt; #  &gt; commit = "1c860959310b80e67c41f7bbdc3e84cef00df18e"),</span></span>
<span><span class="co">#&gt; #  &gt; list(package_name = "fusen",</span></span>
<span><span class="co">#&gt; #  &gt; repo_url = "https://github.com/ThinkR-open/fusen",</span></span>
<span><span class="co">#&gt; #  &gt; commit = "d617172447d2947efb20ad6a4463742b8a5d79dc")),</span></span>
<span><span class="co">#&gt; #  &gt; ide = "none",</span></span>
<span><span class="co">#&gt; #  &gt; project_path = path_default_nix,</span></span>
<span><span class="co">#&gt; #  &gt; overwrite = TRUE)</span></span>
<span><span class="co">#&gt; # It uses nixpkgs' revision 79b3d4bcae8c7007c9fd51c279a8a67acfa73a2a for reproducibility purposes</span></span>
<span><span class="co">#&gt; # which will install R version 4.2.1.</span></span>
<span><span class="co">#&gt; # Report any issues to https://github.com/ropensci/rix</span></span>
<span><span class="co">#&gt; let</span></span>
<span><span class="co">#&gt;  pkgs = import (fetchTarball "https://github.com/NixOS/nixpkgs/archive/79b3d4bcae8c7007c9fd51c279a8a67acfa73a2a.tar.gz") {};</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt;   rpkgs = builtins.attrValues {</span></span>
<span><span class="co">#&gt;     inherit (pkgs.rPackages) </span></span>
<span><span class="co">#&gt;       dplyr</span></span>
<span><span class="co">#&gt;       janitor;</span></span>
<span><span class="co">#&gt;   };</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt;   git_archive_pkgs = [</span></span>
<span><span class="co">#&gt;     (pkgs.rPackages.buildRPackage {</span></span>
<span><span class="co">#&gt;       name = "housing";</span></span>
<span><span class="co">#&gt;       src = pkgs.fetchgit {</span></span>
<span><span class="co">#&gt;         url = "https://github.com/rap4all/housing/";</span></span>
<span><span class="co">#&gt;         rev = "1c860959310b80e67c41f7bbdc3e84cef00df18e";</span></span>
<span><span class="co">#&gt;         sha256 = "sha256-s4KGtfKQ7hL0sfDhGb4BpBpspfefBN6hf+XlslqyEn4=";</span></span>
<span><span class="co">#&gt;       };</span></span>
<span><span class="co">#&gt;       propagatedBuildInputs = builtins.attrValues {</span></span>
<span><span class="co">#&gt;         inherit (pkgs.rPackages) </span></span>
<span><span class="co">#&gt;           dplyr</span></span>
<span><span class="co">#&gt;           ggplot2</span></span>
<span><span class="co">#&gt;           janitor</span></span>
<span><span class="co">#&gt;           purrr</span></span>
<span><span class="co">#&gt;           readxl</span></span>
<span><span class="co">#&gt;           rlang</span></span>
<span><span class="co">#&gt;           rvest</span></span>
<span><span class="co">#&gt;           stringr</span></span>
<span><span class="co">#&gt;           tidyr;</span></span>
<span><span class="co">#&gt;       };</span></span>
<span><span class="co">#&gt;     })</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     (pkgs.rPackages.buildRPackage {</span></span>
<span><span class="co">#&gt;       name = "fusen";</span></span>
<span><span class="co">#&gt;       src = pkgs.fetchgit {</span></span>
<span><span class="co">#&gt;         url = "https://github.com/ThinkR-open/fusen";</span></span>
<span><span class="co">#&gt;         rev = "d617172447d2947efb20ad6a4463742b8a5d79dc";</span></span>
<span><span class="co">#&gt;         sha256 = "sha256-TOHA1ymLUSgZMYIA1a2yvuv0799svaDOl3zOhNRxcmw=";</span></span>
<span><span class="co">#&gt;       };</span></span>
<span><span class="co">#&gt;       propagatedBuildInputs = builtins.attrValues {</span></span>
<span><span class="co">#&gt;         inherit (pkgs.rPackages) </span></span>
<span><span class="co">#&gt;           attachment</span></span>
<span><span class="co">#&gt;           cli</span></span>
<span><span class="co">#&gt;           desc</span></span>
<span><span class="co">#&gt;           devtools</span></span>
<span><span class="co">#&gt;           glue</span></span>
<span><span class="co">#&gt;           here</span></span>
<span><span class="co">#&gt;           magrittr</span></span>
<span><span class="co">#&gt;           parsermd</span></span>
<span><span class="co">#&gt;           roxygen2</span></span>
<span><span class="co">#&gt;           stringi</span></span>
<span><span class="co">#&gt;           tibble</span></span>
<span><span class="co">#&gt;           tidyr</span></span>
<span><span class="co">#&gt;           usethis</span></span>
<span><span class="co">#&gt;           yaml;</span></span>
<span><span class="co">#&gt;       };</span></span>
<span><span class="co">#&gt;     })</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt;     (pkgs.rPackages.buildRPackage {</span></span>
<span><span class="co">#&gt;       name = "AER";</span></span>
<span><span class="co">#&gt;       src = pkgs.fetchzip {</span></span>
<span><span class="co">#&gt;        url = "https://cran.r-project.org/src/contrib/Archive/AER/AER_1.2-8.tar.gz";</span></span>
<span><span class="co">#&gt;        sha256 = "sha256-OqxXcnUX/2C6wfD5fuNayc8OU+mstI3tt4eBVGQZ2S0=";</span></span>
<span><span class="co">#&gt;       };</span></span>
<span><span class="co">#&gt;       propagatedBuildInputs = builtins.attrValues {</span></span>
<span><span class="co">#&gt;         inherit (pkgs.rPackages) </span></span>
<span><span class="co">#&gt;           car</span></span>
<span><span class="co">#&gt;           lmtest</span></span>
<span><span class="co">#&gt;           sandwich</span></span>
<span><span class="co">#&gt;           survival</span></span>
<span><span class="co">#&gt;           zoo</span></span>
<span><span class="co">#&gt;           Formula;</span></span>
<span><span class="co">#&gt;       };</span></span>
<span><span class="co">#&gt;     })</span></span>
<span><span class="co">#&gt;   ];</span></span>
<span><span class="co">#&gt;    </span></span>
<span><span class="co">#&gt;   system_packages = builtins.attrValues {</span></span>
<span><span class="co">#&gt;     inherit (pkgs) </span></span>
<span><span class="co">#&gt;       R</span></span>
<span><span class="co">#&gt;       glibcLocales</span></span>
<span><span class="co">#&gt;       nix;</span></span>
<span><span class="co">#&gt;   };</span></span>
<span><span class="co">#&gt;   </span></span>
<span><span class="co">#&gt; in</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; pkgs.mkShell {</span></span>
<span><span class="co">#&gt;   LOCALE_ARCHIVE = if pkgs.system == "x86_64-linux" then  "${pkgs.glibcLocales}/lib/locale/locale-archive" else "";</span></span>
<span><span class="co">#&gt;   LANG = "en_US.UTF-8";</span></span>
<span><span class="co">#&gt;    LC_ALL = "en_US.UTF-8";</span></span>
<span><span class="co">#&gt;    LC_TIME = "en_US.UTF-8";</span></span>
<span><span class="co">#&gt;    LC_MONETARY = "en_US.UTF-8";</span></span>
<span><span class="co">#&gt;    LC_PAPER = "en_US.UTF-8";</span></span>
<span><span class="co">#&gt;    LC_MEASUREMENT = "en_US.UTF-8";</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt;   buildInputs = [ git_archive_pkgs rpkgs  system_packages   ];</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; }</span></span></code></pre>
<p>The next vignette,
<code><a href="../articles/d2-installing-system-tools-and-texlive-packages-in-a-nix-environment.html">vignette("d2-installing-system-tools-and-texlive-packages-in-a-nix-environment")</a></code>,
explains how you can install tools such as text editors, git, Quarto,
TexLive packages, and any other tool available through
<code>nixpkgs</code> for your development environments.</p>
</div>
<div class="section level2">
<h2 id="package-installation-issues">Package installation issues<a class="anchor" aria-label="anchor" href="#package-installation-issues"></a>
</h2>
<p>Some R packages are quite difficult to install: that is usually not
an issue for most users that use either Windows or macOS as their
operating systems, because when calling <code><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages()</a></code>
a compiled binary gets downloaded from CRAN and installed in a matter of
seconds. On Ubuntu, likely the most popular Linux distribution, binary
packages for R packages are also available via the <a href="https://eddelbuettel.github.io/r2u/" class="external-link">r2u</a> repository. However,
if you need to install old packages, these instead will need to be
installed from source, as binaries for old packages are not kept. For
most packages, this is not an issue, but some packages require
compilation and this is where issues start.</p>
<p>Nix solves this, because all packages must have their dependencies
also declared, so installing old packages should not be an issue.
However, it can happen that one particular package that you want to
install may not build. This can happen because, even though we spend a
lot of time making sure R packages work flawlessly with Nix, there are
many R packages (almost 30’000 between CRAN and Bioconductor) and
there’s not many of us (R contributors for Nix). Should you have trouble
installing a package, feel free to open an issue and we’ll do our best
to fix it!</p>
<p>We also made sure that old packages would work by backporting many
fixes, and actually building many old versions of popular packages for
all the dates included in <code><a href="../reference/available_dates.html">available_dates()</a></code>.</p>
<p>Here is the list of packages that were built and tested (but keep in
mind that this list doesn’t show all the dependencies of all the
packages that also have to work, and that just because a package isn’t
listed, doesn’t mean it’s not going to work!):</p>
<details><summary>
Click to show package list
</summary><pre><code><span></span>
<span><span class="va">DBI</span></span>
<span></span>
<span><span class="va">R6</span></span>
<span></span>
<span><span class="va">RColorBrewer</span></span>
<span></span>
<span><span class="va">RCurl</span></span>
<span></span>
<span><span class="va">RSQLite</span></span>
<span></span>
<span><span class="va">Rcpp</span></span>
<span></span>
<span><span class="va">RcppEigen</span></span>
<span></span>
<span><span class="va">arrow</span></span>
<span></span>
<span><span class="va">askpass</span></span>
<span></span>
<span><span class="va">backports</span></span>
<span></span>
<span><span class="va">base64enc</span></span>
<span></span>
<span><span class="va">bit</span></span>
<span></span>
<span><span class="va">bit64</span></span>
<span></span>
<span><span class="va">blob</span></span>
<span></span>
<span><span class="va">broom</span></span>
<span></span>
<span><span class="va">bslib</span></span>
<span></span>
<span><span class="va">cachem</span></span>
<span></span>
<span><span class="va">callr</span></span>
<span></span>
<span><span class="va">cellranger</span></span>
<span></span>
<span><span class="va">cli</span></span>
<span></span>
<span><span class="va">clipr</span></span>
<span></span>
<span><span class="va">collapse</span></span>
<span></span>
<span><span class="va">colorspace</span></span>
<span></span>
<span><span class="va">cpp11</span></span>
<span></span>
<span><span class="va">crayon</span></span>
<span></span>
<span><span class="va">curl</span></span>
<span></span>
<span><span class="va">data_table</span></span>
<span></span>
<span><span class="va">dbplyr</span></span>
<span></span>
<span><span class="va">devtools</span></span>
<span></span>
<span><span class="va">digest</span></span>
<span></span>
<span><span class="va">dplyr</span></span>
<span></span>
<span><span class="va">duckdb</span></span>
<span></span>
<span><span class="va">evaluate</span></span>
<span></span>
<span><span class="va">fansi</span></span>
<span></span>
<span><span class="va">farver</span></span>
<span></span>
<span><span class="va">fastmap</span></span>
<span></span>
<span><span class="va">fontawesome</span></span>
<span></span>
<span><span class="va">forcats</span></span>
<span></span>
<span><span class="va">fs</span></span>
<span></span>
<span><span class="va">gargle</span></span>
<span></span>
<span><span class="va">generics</span></span>
<span></span>
<span><span class="va">ggplot2</span></span>
<span></span>
<span><span class="va">glue</span></span>
<span></span>
<span><span class="va">gtable</span></span>
<span></span>
<span><span class="va">haven</span></span>
<span></span>
<span><span class="va">highr</span></span>
<span></span>
<span><span class="va">hms</span></span>
<span></span>
<span><span class="va">htmltools</span></span>
<span></span>
<span><span class="va">htmlwidgets</span></span>
<span></span>
<span><span class="va">httr</span></span>
<span></span>
<span><span class="va">icosa</span></span>
<span></span>
<span><span class="va">igraph</span></span>
<span></span>
<span><span class="va">isoband</span></span>
<span></span>
<span><span class="va">jquerylib</span></span>
<span></span>
<span><span class="va">jsonlite</span></span>
<span></span>
<span><span class="va">kit</span></span>
<span></span>
<span><span class="va">knitr</span></span>
<span></span>
<span><span class="va">labeling</span></span>
<span></span>
<span><span class="va">languageserver</span></span>
<span></span>
<span><span class="va">later</span></span>
<span></span>
<span><span class="va">lifecycle</span></span>
<span></span>
<span><span class="va">lubridate</span></span>
<span></span>
<span><span class="va">magrittr</span></span>
<span></span>
<span><span class="va">memoise</span></span>
<span></span>
<span><span class="va">mime</span></span>
<span></span>
<span><span class="va">modelr</span></span>
<span></span>
<span><span class="va">munsell</span></span>
<span></span>
<span><span class="va">nloptr</span></span>
<span></span>
<span><span class="va">openssl</span></span>
<span></span>
<span><span class="va">openxlsx</span></span>
<span></span>
<span><span class="va">pillar</span></span>
<span></span>
<span><span class="va">pkgconfig</span></span>
<span></span>
<span><span class="va">prettyunits</span></span>
<span></span>
<span><span class="va">processx</span></span>
<span></span>
<span><span class="va">progress</span></span>
<span></span>
<span><span class="va">promises</span></span>
<span></span>
<span><span class="va">ps</span></span>
<span></span>
<span><span class="va">purrr</span></span>
<span></span>
<span><span class="va">rJava</span></span>
<span></span>
<span><span class="va">ragg</span></span>
<span></span>
<span><span class="va">rappdirs</span></span>
<span></span>
<span><span class="va">readr</span></span>
<span></span>
<span><span class="va">readxl</span></span>
<span></span>
<span><span class="va">rematch</span></span>
<span></span>
<span><span class="va">rematch2</span></span>
<span></span>
<span><span class="va">rlang</span></span>
<span></span>
<span><span class="va">rmarkdown</span></span>
<span></span>
<span><span class="va">rprojroot</span></span>
<span></span>
<span><span class="va">rstan</span></span>
<span></span>
<span><span class="va">rstudioapi</span></span>
<span></span>
<span><span class="va">rvest</span></span>
<span></span>
<span><span class="va">sass</span></span>
<span></span>
<span><span class="va">scales</span></span>
<span></span>
<span><span class="va">selectr</span></span>
<span></span>
<span><span class="va">Seurat</span></span>
<span></span>
<span><span class="va">sf</span></span>
<span></span>
<span><span class="va">shiny</span></span>
<span></span>
<span><span class="va">stars</span></span>
<span></span>
<span><span class="va">stringi</span></span>
<span></span>
<span><span class="va">stringr</span></span>
<span></span>
<span><span class="va">sys</span></span>
<span></span>
<span><span class="va">systemfonts</span></span>
<span></span>
<span><span class="va">terra</span></span>
<span></span>
<span><span class="va">textshaping</span></span>
<span></span>
<span><span class="va">tibble</span></span>
<span></span>
<span><span class="va">tidyr</span></span>
<span></span>
<span><span class="va">tidyselect</span></span>
<span></span>
<span><span class="va">tidyverse</span></span>
<span></span>
<span><span class="va">timechange</span></span>
<span></span>
<span><span class="va">tinytex</span></span>
<span></span>
<span><span class="va">tzdb</span></span>
<span></span>
<span><span class="va">utf8</span></span>
<span></span>
<span><span class="va">vctrs</span></span>
<span></span>
<span><span class="va">viridisLite</span></span>
<span></span>
<span><span class="va">withr</span></span>
<span></span>
<span><span class="va">xfun</span></span>
<span></span>
<span><span class="va">xlsx</span></span>
<span></span>
<span><span class="va">xml2</span></span>
<span></span>
<span><span class="va">yaml</span></span>
<span></span>
<span><span class="va">zoo</span></span></code></pre>
</details>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><!-- begin footer --><div class="footer">
    <div class="container">
        <div class="row start top-4 bottom-8">
            <div class="col-2"> <img id="footerlogo" src="https://ropensci.org/img/icon_short_white.svg">
</div>
            <div class="col-10">
                <div class="row">
                    <div class="col-md-4 col-xs-6">
                        <a href="https://github.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-github"></div></a>
                        <a href="https://github.com/ropenscilabs" target="_blank" class="external-link"><div class="icon fa fa-flask"></div></a>
                        <a href="https://hachyderm.io/@ropensci" target="_blank" class="external-link"><div class="icon fab fa-mastodon"></div></a>
                        <a href="https://vimeo.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-vimeo"></div></a>
                    </div>
                </div>
                <div class="row top-4">
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">About</h5>
                            <li><a href="https://ropensci.org/about" class="external-link">About rOpenSci</a></li>
                            <li><a href="https://ropensci.org/software-review" class="external-link">Software Review</a></li>
                            <li><a href="https://ropensci.org/about#team" class="external-link">Our Team</a></li>
                            <li><a href="https://ropensci.org/careers" class="external-link">Jobs</a></li>
                            <li><a href="https://ropensci.org/donate" class="external-link">Donate</a></li>
                            <li><a href="https://ropensci.org/contact" class="external-link">Contact Us</a></li>
                        </ul>
</div>
                    <div class="col-md-3 col-sm-4">
                        <ul>
<h5 class="bottom-2">Community</h5>
                            <li><a href="https://ropensci.org/community/" class="external-link">Our Community</a></li>
                            <li><a href="https://ropensci.org/commcalls/" class="external-link">Community calls</a></li>
                            <li><a href="https://ropensci.org/events/" class="external-link">Events</a></li>
                            <li><a href="https://discuss.ropensci.org/" class="external-link">Join the Discussion</a></li>
                            <li><a href="https://ropensci.org/code-of-conduct" class="external-link">Code of conduct</a></li>
                        </ul>
</div>
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">Resources</h5>
                            <li><a href="https://ropensci.org/packages/" class="external-link">Packages</a></li>
                            <li><a href="https://ropensci.org/usecases/" class="external-link">Use Cases</a></li>
                            <li><a href="https://ropensci.org/talks-papers/" class="external-link">Talks &amp; Publications</a></li>
                            <li><a href="https://docs.ropensci.org/" class="external-link">Documentation</a></li>
                            <li><a href="https://ropensci.org/news/" class="external-link">Newsletter</a></li>
                            <li><a href="https://ropensci.org/how-to-cite-ropensci/" class="external-link">Cite rOpenSci</a></li>
                        </ul>
</div>
                    <div class="col-md-4 col-xs-12">
                        <h5 class="bottom-2"></h5>

                        <p>rOpenSci is a fiscally sponsored project of <a href="http://numfocus.org" class="external-link">NumFOCUS</a>.</p>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- / end footer -->


    </footer>
</div>





  </body>
</html>
